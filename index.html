<html>
<script type="text/javascript">
  function getIndex(){
    return document.getElementById("index").value;
  }
  
  function showMessage(message){
    document.getElementById("message").innerHTML = message;
  }
  
  function showCacheSize() {
    showMessage("reading...");
    var index = getIndex();
    caches.open("storage_test")
    .then(cache => {
      return cache.match(getIndex());
    })
    .then(response => {
      if(!response)
        return;
      return response.arrayBuffer();
    })
    .then(buffer => {
      if(!buffer){
        showMessage("no cache");
        return;
      }
      showMessage(buffer.byteLength + "bytes");
    });
  }
  
  function getByteSize(){
    return document.getElementById("size").value;
  }
  
  function putCache() {
    var index = getIndex();
    var length = getByteSize();
    caches.open("storage_test")
    .then(cache => {
      return cache.put(index, new Response(new Int8Array(length)));
    })
    .then(_ => {
      showMessage("done");
    });
  }
</script>
<body>
  Index: <select id="index" name="simple">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    <option>6</option>
    <option>7</option>
    <option>8</option>
    <option>9</option>
    <option>10</option>
  </select>
  <br/>
  <select id="size" name="simple">
    <option value=1000000000>1GB</option>
    <option value=10000000000>10GB</option>
    <option value=1000000>1MB</option>
    <option value=10000000>10MB</option>
  </select>
  <br/>
  <input type="button" value="キャッシュサイズ表示" onclick="showCacheSize();"/> 
  <input type="button" value="キャッシュ生成" onclick="putCache();"/>
  <br/>
  <div id="message"></div>
</body>
</html>
